<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Org Type Quiz</title>
  <meta property="og:title" content="Do Your Decisions Match Your Mission?" />
  <meta property="og:description" content="Take this quick quiz to find out" />
  <meta property="og:image" content="https://www.reflectplando.com/images/quiz-preview.png" />
  <meta property="og:url" content="https://www.reflectplando.com/quiz" />

  <style>
  body {
    font-family: 'Noto Sans', Tahoma, Geneva, Verdana, sans-serif;
    padding: 2rem 1rem;
    max-width: 640px;
    margin: auto;
    background-color: #222222;
    color: #222222;
    line-height: 1.25;
  }

  h1, h2 {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    text-align: center;
    color: #222222;
    font-weight: 600;
    line-height: 1.25;
  }

  .quiz-hero-title {
  font-size: 2.5rem;
  font-weight: 800;
  color: #ff5757; 
  margin-bottom: 0.5rem;
  line-height: 1.25;
  }

 .quiz-hero-subtitle {
  font-size: 1.1rem;
  line-height: 1.25;
  color: #fff; 
  margin-bottom: 0.5rem;
  }

  .question {
    background: #fff;
    padding: 1.25rem;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
    line-height: 1.15;
    margin-bottom: 1rem;
  }

  .question p {
    margin-top: 0;
    margin-bottom: .5rem;
    line-height: 1.25;

    font-weight: bold;
    font-size: 1.1rem;
  }

  .question label {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    padding: 0.4rem 0;
    cursor: pointer;
  }

  input[type="radio"] {
    margin-top: 0.2rem;
    margin-right: 0.5rem;
    margin-left: 0.5rem;
  }

  button {
    background-color: #fff;
    color: #444444;
    border: none;
    padding: 0.6rem 1.2rem;
    font-size: 1rem;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    display: block;
    margin: 1.5rem auto 0;
  }

  button:hover {
    background-color: #d9d9d9;
  }

  .result {
    background: #fff;
    padding: 1.5rem;
    
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.07);
    margin-top: 0rem;
    text-align: center;
  }

  .cta-button {
    display: inline-block;
    background-color: #fd0c31;
    color: #fff !important;
    padding: 0.6rem 1.2rem;
    text-decoration: none;
    border-radius: 6px;
    font-weight: strong;
    margin-top: .5rem;
    transition: background-color 0.2s ease;
  }

  .cta-button:hover {
    background-color: #ffb8b8;
    color: #444444 !important;
  }

  .cta-button-outline {
  background: none;
  color: #fd0c31;              /* Use your brand color */
  border: 2px solid #fd0c31;   /* Outline with brand color */
  padding: 0.6rem 1.2rem;
  border-radius: 6px;
  margin-top: .5rem;
  text-decoration: none;
  transition: background 0.2s, color 0.2s;
  cursor: pointer;
  display: inline-block;
}

.cta-button-outline:hover {
  background: none;
  color: #ffb8b8;              /* Use your brand color */
  border: 2px solid #ffb8b8;   /* Outline with brand color */
  padding: 0.6rem 1.2rem;
  border-radius: 6px;
  text-decoration: none;
  transition: background 0.2s, color 0.2s;
  cursor: pointer;
  display: inline-block;
}

  .restart-button {
    background-color: #444444;
    color: #fff;
    border: none;
    padding: 0.6rem 1.2rem;
    font-size: 1rem;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    display: block;
    margin: 1.5rem auto 0;
  }

  .restart-button:hover {
  background-color: #7e87b2;
}

  .step {
    display: none;
  }

  .step.active {
    display: block;
  }

  #nextBtn {
  display: block;
  margin: 1.5rem auto 0;
  }

  .planner-content {
    border: 2px solid #fd0c31;
    border-radius: 12px;
    padding: 1rem;
    margin: 1rem 0;
    background: #fff;
  }

  .planner-content li {
  line-height: 1.2;         /* space between lines within a list item */
  padding-bottom: 0.1rem;   /* space below each list item */
}

.planner-content p {
  line-height: 1.2;         /* space between lines within a list item */
  padding-bottom: 0.1rem;   /* space below each list item */
}


  .prompt-container {
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
  }
  
  </style>

</head>
<body>  
  <section style="text-align: center; padding: 2rem 1rem; max-width: 600px; margin: auto;">
  

</section>

  <form id="quizForm">
    <div class="step active" data-step="1">
      <div class="question">
        <p>What best describes how your team sets goals?</p>
        <label><input type="radio" name="q1" value="0,0" required /> We're guided by values but don't always have clear targets.</label><br/>
        <label><input type="radio" name="q1" value="0,1" /> We track progress toward program goals but not revenue.</label><br/>
        <label><input type="radio" name="q1" value="0,2" /> We have performance and financial metrics, but they're siloed.</label><br/>
        <label><input type="radio" name="q1" value="0,3" /> We set shared goals across departments with regular reviews.</label>
      </div>
    </div>
    <div class="step" data-step="2">
      <div class="question">
        <p>How accessible is your data to people across your team?</p>
        <label><input type="radio" name="q2" value="0,0" required /> Not accessible.</label><br/>
        <label><input type="radio" name="q2" value="1,0" /> Only select leaders have access.</label><br/>
        <label><input type="radio" name="q2" value="2,0" /> It's technically accessible, but underused.</label><br/>
        <label><input type="radio" name="q2" value="3,0" /> Easy to access and actively used in decision-making.</label>
      </div>
    </div>
    <div class="step" data-step="3">
      <div class="question">
        <p>What's your relationship with data?</p>
        <label><input type="radio" name="q3" value="0,0" required /> We collect data for funders, but it doesn't inform decisions.</label><br/>
        <label><input type="radio" name="q3" value="1,0" /> We wish we had better data but aren't sure where to start.</label><br/>
        <label><input type="radio" name="q3" value="2,0" /> We have plenty of data, but it's not always actionable.</label><br/>
        <label><input type="radio" name="q3" value="3,0" /> Integrated data from multiple teams/sources helps us make decisions and tell our story.</label>
      </div>
    </div>
    <div class="step" data-step="4">
      <div class="question">
        <p>How often do you revisit or adjust your metrics?</p>
        <label><input type="radio" name="q4" value="0,0" required /> Rarely. We mostly just report on what we already track.</label><br/>
        <label><input type="radio" name="q4" value="1,0" /> When funders ask or something major changes.</label><br/>
        <label><input type="radio" name="q4" value="2,0" /> We check in occasionally but don't have a set cadence.</label><br/>
        <label><input type="radio" name="q4" value="3,0" /> We regularly review and evolve our metrics based on performance and revenue outcomes.</label>
      </div>
    </div>
    <div class="step" data-step="5">
      <div class="question">
        <p>How do fundraising and programs work together?</p>
        <label><input type="radio" name="q5" value="0,0" required /> Like neighbors who nod but rarely talk.</label><br/>
        <label><input type="radio" name="q5" value="0,1" /> They team up when deadlines demand it.</label><br/>
        <label><input type="radio" name="q5" value="0,2" /> They share information but aren't truly aligned.</label><br/>
        <label><input type="radio" name="q5" value="0,3" /> They work closely and use shared metrics to plan and reflect.</label>
      </div>
    </div>
    <div class="step" data-step="6">
      <div class="question">
        <p>What challenge feels most familiar right now?</p>
        <label><input type="radio" name="q6" value="0,0" required /> We want to make a difference, but it's unclear what to focus on.</label><br/>
        <label><input type="radio" name="q6" value="0,1" /> We feel we're making a difference within our own team but don't know the effect on other teams.</label><br/>
        <label><input type="radio" name="q6" value="0,2" /> We have clear goals that are aligned across the organization and know we are making an impact, but accessing reports that demonstrate this is draining.</label><br/>
        <label><input type="radio" name="q6" value="0,3" /> Our goals are aligned, and we have access to accurate reports and/or dashboards to track progress and inform decisions in a timely manner.</label>
      </div>

      <button type="submit">See My Results</button>
    </div>
    <button type="button" id="nextBtn">Next</button>
  </form>

<div class="result" id="result" style="display:none;">
  <h1><span id="orgType"></span></h1>
  <p id="orgDesc"></p>

  <div class="cta-buttons" style="margin-top: 1rem; display: flex; flex-direction: column; gap: 0.2rem; align-items: center;">
    <a href="#" id="plannerLink" class="cta-button">Get My Custom Strategy Guide</a>

    <a href="#" id="recommendationsLink" class="cta-button-outline" target="_blank">Explore on My Own</a>
  </div>

  <p style="margin-top: 1.5rem;">
  <a href="#" id="restartLink" style="color: #fd0c31; font-size: 0.95rem;">
    Take the quiz again
  </a>
  <p style="text-align: center; margin-top: 1rem; font-style: italic; font-weight: bold; font-size: 0.75rem; color: #7e87b2;">Custom Strategy Guide is based on your unique combination of responses. It includes a guide to your style, coaching prompts, and clear next steps to move your mission forward.</p>
</p>
</div>

<div id="plannerForm" style="display: none;" class="result">
  <h2>Unlock Your Custom Strategy Guide</h2>
  <p style="text-align: center; margin-bottom: 2rem; font-weight: bold">
    Your custom planner includes a guide to your style, coaching prompts, and clear next steps to move your mission forward.
  </p>

  <div style="background: #fff; padding: 1rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.07);">


    <form id="strategyPlannerForm">
      <div style="margin-bottom: 1rem;">
        <label for="email" style="display: block; margin-bottom: 0.5rem; font-style: italic; font-size: 0.9rem; color: #222222;">*Email Address</label>
        <input type="email" id="email" name="email" required style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
      </div>

      <div style="margin-bottom: 1rem;">
        <label for="name" style="display: block; margin-bottom: 0.5rem; font-style: italic; font-size: 0.9rem; color: #222222;">Name</label>
        <input type="text" id="name" name="name" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
      </div>

      <div style="margin-bottom: 1rem;">
        <label for="title" style="display: block; margin-bottom: 0.5rem; font-style: italic; font-size: 0.9rem; color: #222222;">Title/Role</label>
        <input type="text" id="title" name="title" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
      </div>

      <div style="margin-bottom: 1rem;">
        <label for="org" style="display: block; margin-bottom: 0.5rem; font-style: italic; font-size: 0.9rem; color: #222222;">Organization Name</label>
        <input type="text" id="org" name="org" style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
      </div>

      <div style="margin-bottom: 1rem;">
        <label style="display: flex; align-items: center; gap: 0.5rem; color: #222222; font-style: italic; font-size: 0.9rem;">
          <input type="checkbox" id="newsletter" name="newsletter">
          Keep me posted on new tools and trainings.
        </label>
      </div>

      <button type="submit" class="cta-button" style="width: 100%; margin-bottom: 1rem;">See My Custom Strategy Guide</button>

      <p style="text-align: center; margin-top: .7rem; font-size: 0.9rem; font-style: italic; font-weight: bold; color: #444444;">
        *We respect your privacy and inbox.</br>We'll only send you information you've asked for.
      </p>

      <p style="text-align: center; margin-bottom: 1rem;"><small><em>Still Deciding?</br>
         <a id="exploreOnMyOwnUnlock"  href="#" target="_blank" style="color:#fd0c31; width: 60%;">Explore on Your Own</a>
        </em></small></p>

    </form>



    
  </div>
</div>

<div id="plannerDisplay" style="display: none; margin-bottom: 0rem;" class="result">
  <p style="text-align: center; margin-bottom: .5rem; font-style: bold">
  </p>
  
  <div style="background: #fff; padding: 0rem; border-radius: 12px; box-shadow: 0 2px 2px rgba(0, 0, 0, 0);">
    <div id="plannerContent">
      <!-- Planner content will be generated here -->
    </div>

    <div style="margin-top: 1rem; display: flex; flex-direction: column; align-items: center;">
      <p style="margin-bottom: 0.5rem;"><small><b>Take this with you!</b><br/>
        <em>Download a printable version to share or revisit when you're ready.</em></small></p>
      <button id="downloadPDF" class="cta-button-outline" style="margin-top: 0.5rem;">Download PDF</button>
    
      <a href="#" id="backToQuiz" style="color: #222222; margin-top: 1rem; text-decoration: underline; font-size: 0.95rem;">Take the quiz again</a>

    </div>
  </div>
</div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <script>
    const steps = document.querySelectorAll('.step');
    let currentStep = 0;
    const nextBtn = document.getElementById('nextBtn');

  nextBtn.addEventListener('click', () => {
  const currentInputs = steps[currentStep].querySelectorAll('input[type="radio"]');
  const oneChecked = Array.from(currentInputs).some(input => input.checked);

  if (!oneChecked) {
    alert("Please select an answer.");
    return;
  }

  steps[currentStep].classList.remove('active');
  currentStep++;
  steps[currentStep].classList.add('active');

  if (currentStep === steps.length - 1) {
    nextBtn.style.display = 'none';
  }
});


  const descriptions = {
  "Heart-Led Hustler": {
    text: "You lead with purpose, passion, and people in mind. Your mission inspires action—but without shared goals and structure, things can get chaotic. With the right support, your heart can drive even greater impact.<br/><br/><b>Not All Heart-Led Hustlers Are the Same.<br/>Your Custom Strategy Guide Has Insights for You.</b>",
    lockedText: "Your results show that you have a clear sense of the importance of your work. What you need now is structure to sustain that passion and build a lasting legacy. Use the prompts below—solo or with your team—to help your team align mission, metrics, and momentum.",
    link: "https://www.reflectplando.com/heart-led-hustler",
    shortLink: "reflectplando.com/heart-led-hustler"
  },
  "Insight Seeker": {
    text: "You ask the right questions and crave better data to guide your decisions. You value strategy and reflection—but without the right tools, insights can get stuck in silos. You're ready to turn curiosity into clarity—and clarity into action.<br/><br/><b>Not All Insight Seekers Are the Same.<br/>Your Custom Strategy Guide Has Insights for You.</b>",
    lockedText: "Your results reflect a thoughtful, values-driven organization with a hunger for deeper understanding. It's time to build the structure that lets people engage with the data, ask better questions, and move ideas into motion. Use the prompts below—solo or with your team—to turn questions into answers.",
    link: "https://www.reflectplando.com/insight-seeker",
    shortLink: "reflectplando.com/insight-seeker"
  },
  "Resourceful Reactor": {
    text: "You're scrappy, responsive, and always ready to adapt. When challenges pop up, your team finds a way—but without clear systems, it's hard to sustain progress. You make things work in the moment—now it's time to build for what's next.<br/><br/><b>Not All Resourceful Reactors Are the Same.<br/>Your Custom Strategy Guide Has Insights for You.</b>",
    lockedText: "Your results suggest that while your organization knows how to get things done, it may be operating in a reactive mode. Your next step is to bring teams together around common goals. Use the prompts below—solo or with your team—to align your strategic direction with your operational strengths.",
    link: "https://www.reflectplando.com/resourceful-reactor",
    shortLink: "reflectplando.com/resourceful-reactor"
  },
  "Mission Mover": {
    text: "You turn alignment into action. With clear goals, connected teams, and the right structure in place, your organization is ready for lift-off. You don't just talk about impact—you make it happen.<br/><br/><b>Not All Mission Movers Are the Same.<br/>Your Custom Strategy Guide Has Insights for You.</b>",
    lockedText: "Your results show that your organization has both clarity of purpose and the structure to support it—ideal for scalable, sustainable impact. The opportunity is maintaining momentum. Use the prompts below—solo or with your team—to strengthen alignment, reinforce strategy, and look forward to the next mission.",
    link: "https://www.reflectplando.com/mission-mover",
    shortLink: "reflectplando.com/mission-mover"
  }
};

    document.getElementById('quizForm').addEventListener('submit', function(e) {
      e.preventDefault();
      let formData = new FormData(this);
      let structure = 0, alignment = 0;
      for (let value of formData.values()) {
        let [s, a] = value.split(',').map(Number);
        structure += s;
        alignment += a;
      }

      let type = '';
           if (structure >= 7 && alignment >= 7) type = 'Mission Mover';
      else if (structure <= 6 && alignment >= 7) type = 'Insight Seeker';
      else if (structure <= 6 && alignment <= 6) type = 'Heart-Led Hustler';
      else if (structure >= 7 && alignment <= 6) type = 'Resourceful Reactor';
      else type = 'caseBreakline162';


      const answers = {};
let index = 1;
for (let value of formData.values()) {
  answers[`q${index}`] = value;
  index++;
}

sendToSheet({
  orgType: type,
  structure,
  alignment,
  answers,
  cta: '',         // will fill this in later when CTA is clicked
  name: '',        // placeholder for later
  title: '',
  email: '',
  org: '',
  function: ''
});


      
      document.getElementById('quizForm').style.display = 'none';
      document.getElementById('result').style.display = 'block';
     
      const emojiMap = {
  "Heart-Led Hustler": "❤️",
  "Insight Seeker": "🧭",
  "Resourceful Reactor": "🧨",
  "Mission Mover": "🚀"
};

document.getElementById('orgType').textContent = `${emojiMap[type]} ${type}`;

            
document.getElementById('orgDesc').innerHTML = `
  <p>${descriptions[type].text}</p>
`;

// Update the recommendations link based on org type
document.getElementById('recommendationsLink').href = descriptions[type].link;

// Update the planner link click handler
document.getElementById('plannerLink').addEventListener('click', (e) => {
  e.preventDefault();
  document.getElementById('result').style.display = 'none';
  document.getElementById('plannerForm').style.display = 'block';
  document.getElementById('exploreOnMyOwnUnlock').href = descriptions[type].link;
});

// Add another update planner link click handler
document.getElementById('plannerLink2').addEventListener('click', (e) => {
  e.preventDefault();
  document.getElementById('result').style.display = 'none';
  document.getElementById('plannerForm').style.display = 'block';
  document.getElementById('exploreOnMyOwnUnlock').href = descriptions[type].link;
});

    });

   document.getElementById('restartLink').addEventListener('click', (e) => {
  document.getElementById('result').style.display = 'none';
  document.getElementById('quizForm').style.display = 'block';
  steps.forEach((step, i) => {
    step.classList.remove('active');
    if (i === 0) step.classList.add('active');
  });
  currentStep = 0;
  nextBtn.style.display = 'inline-block';

  // Clear all answers
  document.querySelectorAll('input[type="radio"]').forEach(input => input.checked = false);
});

// Constants and configuration
const EMOJI_MAP = {
  "Heart-Led Hustler": "❤️",
  "Insight Seeker": "🧭",
  "Resourceful Reactor": "🧨",
  "Mission Mover": "🚀"
};

const STANDARD_PROMPTS = {
  reflect: [
    "How do you share the story that data is telling?",
    "Is this a personal need or a systemic one? Are the challenges you're facing tied to your role—or are they rooted in broader organizational patterns?"
  ],
  plan: [
    "What might prevent success?",
    "Who should be involved in seeing this through?",
    "Who else might benefit from learning how to tell compelling stories with data?"
  ]
};

const ANSWER_PROMPTS = {
  q1: {
    "0,0": "What are your guiding values? How do people know?",
    "0,1": "How do you track program goals? How does your work affect revenue?",
    "0,2": "Why are metrics siloed? How could sharing them improve org value?",
    "0,3": "What keeps goals in focus between reviews when decisions are being made?"
  },
  q2: {
    "0,0": "How do you access and use data for solo tasks?",
    "1,0": "What is the process for select leaders to access and use data?",
    "2,0": "In what situations do people use the available data? How actionable is existing data?",
    "3,0": "Can people access useful reports and dashboards in under five minutes to inform timely decision-making?"
  },
  q3: {
    "0,0": "How are decisions made? How do you keep track of data?",
    "1,0": "What kind of data would help your organization the most?",
    "2,0": "Where does data live? Why isn't it actionable?",
    "3,0": "What is your org's story? How has it evolved over time? What's the next chapter?"
  },
  q4: {
    "0,0": "What do you currently track? How is it related to daily activities?",
    "1,0": "How does the organization anticipate major changes? How are funders' needs communicated?",
    "2,0": "What spurs the occasional metric check-ins? What do check-ins look like?",
    "3,0": "What does the evolution of metrics in response to performance and revenue outcomes look like?"
  },
  q5: {
    "0,0": "What could improve collaboration between your fundraising and program teams?",
    "0,1": "What tangible results would you expect from regular collaboration between fundraising and program teams?",
    "0,2": "How do fundraising and programs share information? What kind of information do they share?",
    "0,3": "What is the glue that keeps the fundraising and program teams working together? How do they share success stories and maintain momentum?"
  },
  q6: {
    "0,0": "What would making a difference look like?",
    "0,1": "Who does know the effect of your work on other teams? How do they know? What opportunities exist for interacting with other teams?",
    "0,2": "What makes it difficult to access useful reports? How do you typically work around this? How do you tell the story of your success to stakeholders?",
    "0,3": "How is the organization progressing on its goals? What challenges are on the horizon?"
  }
};

// Helper functions
function cleanOrgType(orgType) {
  return orgType.replace(/[^a-zA-Z\s-]/g, '').trim();
}

function generatePromptList(prompts) {
  return prompts.map(prompt => `
    <li style="margin-bottom: 1rem; padding: 1rem; background: #ffffff; border-radius: 8px;">
      <p style="margin: 0; color: #222222;">${prompt}</p>
    </li>
  `).join('');
}

// Main planner generation function
function generatePlanner(orgType, answers) {
  const orgTypeClean = cleanOrgType(orgType);
  const emoji = EMOJI_MAP[orgTypeClean] || '❤️';
  
  // Generate custom prompts based on answers
  const customPrompts = Object.entries(answers).map(([q, value]) => ANSWER_PROMPTS[q][value]);

  return `
    <div class="planner-content">
      <h3 style="color: #222222; margin-bottom: 0rem; text-align: center; padding: 0rem;">Custom Strategy Guide</h3>

      <h1 style="color: #222222; margin-bottom: .5rem; text-align: center; padding: 0rem;">Your ${orgType} <br/>Quadrant Placement</h1>
      
      <div style="margin-bottom: .5rem; padding: 0 1rem;">
        <div style="display: flex; align-items: center; gap: 0rem; margin-bottom: 0rem;">
          
        </div>
        <p>${descriptions[orgTypeClean]?.lockedText || descriptions["Heart-Led Hustler"].lockedText}</p>
      </div>

      <div style="margin-bottom: .5rem;">
        <h3 style="color: #222222; margin-bottom: .5rem;">Reflect</h3>
    
        <ul style="list-style: none; padding: 0;">
          ${generatePromptList(customPrompts)}
          ${generatePromptList(STANDARD_PROMPTS.reflect)}
        </ul>
      </div>

      <div style="margin-bottom: 1rem;">
        <h3 style="color: #222222; margin-bottom: .5rem;">Plan</h3>
        <ul style="list-style: none; padding: 0;">
          ${generatePromptList(STANDARD_PROMPTS.plan)}
        </ul>
      </div>

      <div style="margin-bottom: 1rem;">
        <h3 style="color: #222222; margin-bottom: 0.5rem;">Do!</h3>
        <p style="margin-bottom: 0.5rem;"><b>Need clarity on what to do next?</b></br>
          A 45-minute Action Session connects your quiz insights to real decisions. You walk away with focused next steps.<br/></p>
        <a href="https://www.reflectplando.com/quiz-credit" target="_blank" class="cta-button" style="margin-top: 0.5rem;">Book a Chat to Learn More</a>

      
        <p><small>${descriptions[orgTypeClean]?.link || descriptions["Heart-Led Hustler"].link}</small></p>

        </div>
    </div>
  `;
}

// Update form submission handler
document.getElementById('strategyPlannerForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  // Get form data
  const formData = {
    email: document.getElementById('email').value,
    name: document.getElementById('name').value,
    org: document.getElementById('org').value,
    title: document.getElementById('title').value,
    newsletter: document.getElementById('newsletter').checked,
    orgType: document.getElementById('orgType').textContent,
    answers: {}
  };

  // Get quiz answers
  const quizAnswers = {};
  document.querySelectorAll('input[type="radio"]:checked').forEach((input) => {
    const questionName = input.name;
    quizAnswers[questionName] = input.value;
  });

  // Generate and display planner
  const plannerContent = generatePlanner(formData.orgType, quizAnswers);
  document.getElementById('plannerContent').innerHTML = plannerContent;
  
  // Show planner and hide form
  document.getElementById('plannerForm').style.display = 'none';
  document.getElementById('plannerDisplay').style.display = 'block';

  // Scroll to top of the page
  window.scrollTo(0, 0);

  // Send data to Google Sheet
  sendToSheet({
    ...formData,
    answers: quizAnswers
  });
});

// Add back to quiz handler
document.getElementById('backToQuiz').addEventListener('click', (e) => {
  e.preventDefault();
  document.getElementById('plannerDisplay').style.display = 'none';
  document.getElementById('quizForm').style.display = 'block';
  document.querySelectorAll('input[type="radio"]').forEach(input => input.checked = false);
  currentStep = 0;
  steps.forEach((step, i) => {
    step.classList.remove('active');
    if (i === 0) step.classList.add('active');
  });
  nextBtn.style.display = 'inline-block';
});

// Add PDF download functionality
document.getElementById('downloadPDF').addEventListener('click', async function() {
  const button = this;
  const originalText = button.textContent;
  button.textContent = 'Generating PDF...';
  button.disabled = true;
  
  try {
    // Create new PDF document
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    
    // Set initial position
    let y = 20;
    
    // Add title
    doc.setFontSize(20);
    doc.setFont("helvetica", "bold");
    doc.setTextColor('#fd0c31')
    //doc.setTextColor('#FF5757'); //this changed the whole doc, not just the header!
    doc.text("Custom Strategy Guide", 20, y);
    y += 10;

    // Reset font for body text
    doc.setFontSize(11);
    doc.setFont("helvetica", "normal");
    doc.setTextColor(76, 82, 112)


    // Add organization type (without emoji)
    doc.setFontSize(14);
    doc.setFont("helvetica", "bold");
    const orgType = document.getElementById('orgType').innerText.split(' ').slice(1).join(' ');
    doc.text(orgType, 20, y);
    y += 5;
    
    // Reset font for body text
    doc.setFontSize(11);
    doc.setFont("helvetica", "normal");
    
    // Get content and split into lines
    const content = document.getElementById('plannerContent').innerText;
    const lines = content.split('\n');
    
    // Process content
    let currentSection = '';
    const pageWidth = doc.internal.pageSize.width;
    const margin = 20;
    const maxWidth = pageWidth - (2 * margin);
    
    // Skip the first few lines that contain the title and organization type
    const contentLines = lines.slice(3);
    

    contentLines.forEach(line => {
      if (line.trim()) { // Only process non-empty lines
        // Check if this is a section header
        if (line.includes('Reflect') || line.includes('Plan') || line.includes('Do!')) {
          y += 5; // Add extra space before section
          doc.setFontSize(14);
          doc.setFont("helvetica", "bold");
          currentSection = line;
          doc.text(line, 20, y);
          y += 6;
        } else if (line.startsWith('•')) {
          // Handle bullet points
          doc.setFontSize(10);
          doc.setFont("helvetica", "normal");
          y += 6;
          doc.text(line, 20, y);
          y += 6;
          y += 4; // Add extra space after each prompt
        } else {
          // Regular text
          doc.setFontSize(11);
          doc.setFont("helvetica", "normal");

          if (line.includes('Book a Chat to Learn More')) {
            line = 'Book a Chat to Learn More: https://www.reflectplando.com/quiz-credit';
            doc.text(line, 20, y);
            y += 7;
            y += 5; // Add extra space after the link
            
            // Add website link
            doc.setFontSize(11);
            doc.setFont("helvetica", "bold");
            //doc.setTextColor('#FF5757');
            const websiteLink = 'Notes';
            doc.text(websiteLink, 20, y);
            
            y += 7;
          } 
          
          
          
          
          else {
            const maxWidth = pageWidth - (2 * margin);
            const splitLines = doc.splitTextToSize(line, maxWidth);
            splitLines.forEach(splitLine => {
              doc.text(splitLine, 20, y);
              y += 5; // adjust line spacing within paragraphs
            });
            y += 0;
            y += 3; // Add extra space after paragraph
            
            // Check if we need a new page
            if (y > 270) {
              doc.addPage();
              y = 20;
            }
          }
        }
      }
    });

    
    // Save the PDF
    doc.save('custom-strategy-planner.pdf');
    
    // Update button to show success
    button.textContent = 'PDF Downloaded!';
    setTimeout(() => {
      button.textContent = originalText;
      button.disabled = false;
    }, 2000);
    
  } catch (error) {
    console.error('Error:', error);
    button.textContent = 'Error - Try Again';
    setTimeout(() => {
      button.textContent = originalText;
      button.disabled = false;
    }, 2000);
  }
});

// Update the consultation link to open in a new tab
document.querySelector('a[href="https://www.reflectplando.com/quiz-credit"]').setAttribute('target', '_blank');

  function sendToSheet(data) {
    // Show loading state
    const submitButton = document.querySelector('button[type="submit"]');
    const originalButtonText = submitButton.textContent;
    submitButton.textContent = 'Saving...';
    submitButton.disabled = true;

    // Create a form submission
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = 'https://script.google.com/macros/s/AKfycbwWixTRcao1qgiwNTuMD5SCMk6El9iSMFfD6N37zShkF2C289jIdIyojjlVTT6_ra55/exec';
    form.target = 'form-response'; // Target an iframe instead of new tab

    // Create and append iframe for response
    const iframe = document.createElement('iframe');
    iframe.name = 'form-response';
    iframe.style.display = 'none';
    document.body.appendChild(iframe);

    // Add all data as hidden inputs
    const formData = {
      orgType: data.orgType,
      structure: data.structure,
      alignment: data.alignment,
      q1: data.answers.q1,
      q2: data.answers.q2,
      q3: data.answers.q3,
      q4: data.answers.q4,
      q5: data.answers.q5,
      q6: data.answers.q6,
      ctaClicked: data.cta,
      name: data.name,
      title: data.title,
      email: data.email,
      orgName: data.org,
      orgFunction: data.function
    };

    // Create hidden inputs for each field
    Object.entries(formData).forEach(([key, value]) => {
      const input = document.createElement('input');
      input.type = 'hidden';
      input.name = key;
      input.value = value;
      form.appendChild(input);
    });

    // Add form to document, submit it, and remove it
    document.body.appendChild(form);
    form.submit();

    // Handle the response
    iframe.onload = function() {
      // Remove the iframe
      document.body.removeChild(iframe);
      document.body.removeChild(form);
      
      // Show success state
      submitButton.textContent = originalButtonText;
      submitButton.style.backgroundColor = '#7ed957';
      submitButton.style.color = '#fff';
      
      // Reset button after 2 seconds
      setTimeout(() => {
        submitButton.textContent = originalButtonText;
        submitButton.disabled = false;
        submitButton.style.backgroundColor = '';
        submitButton.style.color = '';
      }, 2000);
    };

    // Handle errors
    iframe.onerror = function() {
      submitButton.textContent = 'Error - Try Again';
      submitButton.disabled = false;
      alert('There was an error saving your results. Please try again.');
    };
  }

  // Initialize EmailJS with your public key
  (function() {
    emailjs.init("YOUR_PUBLIC_KEY"); // You'll need to replace this with your actual EmailJS public key
  })();

  // Function to send PDF via email
  async function sendPDFByEmail(pdfBlob) {
    try {
      const formData = new FormData();
      formData.append('pdf', pdfBlob, 'custom-strategy-planner.pdf');
      
      const response = await emailjs.send(
        'YOUR_SERVICE_ID', // You'll need to replace this with your EmailJS service ID
        'YOUR_TEMPLATE_ID', // You'll need to replace this with your EmailJS template ID
        {
          to_email: document.getElementById('email').value,
          message: 'Here is your custom strategy guide!',
          pdf: pdfBlob
        }
      );
      
      console.log('Email sent successfully:', response);
      return true;
    } catch (error) {
      console.error('Error sending email:', error);
      return false;
    }
  }

  </script>
  
  <div style="text-align: center; margin-top: 2rem;">
  <img
    src="https://lhearnsb.github.io/reflectplando-quiz/logo.png"
    alt="Reflect Plan Do Logo"
    style="max-width: 120px; height: auto;"
  />
</div>

</body>
</html>
